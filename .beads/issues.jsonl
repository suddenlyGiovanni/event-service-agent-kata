{"id":"event-service-agent-kata-19k","title":"Timer polling worker: implement WorkerRunner entrypoint (worker thread)","description":"Create Bun worker-thread entrypoint that runs WorkerRunner.layerSerialized with handlers. StartPolling launches pollDueTimersWorkflow loop inside worker, StopPolling/interrupt stops it. Worker owns DB + EventBus layers and is self-sufficient once started.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T12:28:23.204097+01:00","updated_at":"2025-12-16T12:28:23.204097+01:00","labels":["Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-19k","depends_on_id":"event-service-agent-kata-axe","type":"discovered-from","created_at":"2025-12-16T12:28:49.469098+01:00","created_by":"daemon"}]}
{"id":"event-service-agent-kata-3fd","title":"API server with submit/list/detail routes","description":"Minimal HTTP server with routes from modules/api.md. Validate input, publish SubmitServiceCall. Read models served directly from domain DB with pagination and filters.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-14T22:05:12.414714821Z","updated_at":"2025-12-14T22:05:12.414714821Z","labels":["ADR-0007","Api","PL-7"]}
{"id":"event-service-agent-kata-961","title":"Orchestration core domain model and transitions","description":"Model ServiceCall aggregate as discriminated union with legal transitions only. Implement handlers for SubmitServiceCall, DueTimeReached, and Execution* events.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-14T22:04:34.798969366Z","updated_at":"2025-12-17T19:21:42.834098+01:00","labels":["Orchestration","PL-2"]}
{"id":"event-service-agent-kata-aro","title":"Execution module with mock HttpClientPort","description":"Implement Execution module with HttpClientPort adapter. Mock client for offline tests, real client optional. Emits ExecutionStarted then exactly one of ExecutionSucceeded/ExecutionFailed.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-14T22:04:53.848065269Z","updated_at":"2025-12-14T22:04:53.848065269Z","labels":["Execution","PL-5"]}
{"id":"event-service-agent-kata-axe","title":"Timer: migrate polling worker to @effect/platform Worker","description":"Re-scope: split Timer into main thread (command subscription + config) and a single Bun Worker thread running pollDueTimersWorkflow. Worker is self-sufficient once started (DB + EventBus access). Main passes config via StartPolling message and propagates shutdown/interrupt to worker.\n\nPlan / Tasks:\n- event-service-agent-kata-cpx (P1): define worker request protocol (Schema-tagged) incl. StartPolling(config) + StopPolling\n- event-service-agent-kata-19k (P1): implement worker-thread entrypoint using WorkerRunner.layerSerialized\n- event-service-agent-kata-hjq (P1): main-thread runtime: subscribe to commands, spawn 1 worker, send StartPolling, propagate shutdown; fail-fast on worker death (restart TODO)\n- event-service-agent-kata-elk (P1): tests for protocol + worker lifecycle + shutdown propagation\n- event-service-agent-kata-bdr (P2): scripts/path resolution + docs (Timer/AGENTS)\n\nDecisions:\n- Config source of truth is main thread; pass to worker via StartPolling message (even if using default 5s interval now).\n- Worker cadence/scheduling lives inside worker (isolated); main only starts/stops.\n- Shutdown propagates interruption; worker must stop within bounded time.\n- Restart policy not part of MVP: fail-fast with clear logs; track restart/backoff as follow-up if needed.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-16T11:20:34.397442+01:00","updated_at":"2025-12-17T19:21:50.064119+01:00","labels":["PL-4","Timer","platform"]}
{"id":"event-service-agent-kata-bdr","title":"Timer worker migration: scripts/build path + docs","description":"Ensure Bun Worker entrypoint path resolution works in dev/test. Add/adjust package scripts if needed. Update Timer docs/AGENTS.md to describe main-thread vs worker-thread responsibilities, config message passing, and shutdown behavior.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T12:28:36.149536+01:00","updated_at":"2025-12-16T12:28:36.149536+01:00","labels":["Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-bdr","depends_on_id":"event-service-agent-kata-axe","type":"discovered-from","created_at":"2025-12-16T12:28:58.164976+01:00","created_by":"daemon"}]}
{"id":"event-service-agent-kata-bja","title":"SQLite persistence adapter [Timer]","description":"COMPLETE: 3-phase implementation with TDD discipline. Full CRUD operations (save, find, findScheduledTimer, findDue, markFired, delete) with idempotency, tenant isolation, and state transitions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T22:05:40.524764429Z","updated_at":"2025-12-14T22:05:49.42611217Z","closed_at":"2025-12-14T22:05:49.42611217Z","labels":["PL-4.6","Timer"],"dependencies":[{"issue_id":"event-service-agent-kata-bja","depends_on_id":"event-service-agent-kata-ymr","type":"parent-child","created_at":"2025-12-14T22:05:49.440454049Z","created_by":"daemon"}]}
{"id":"event-service-agent-kata-cpx","title":"Timer polling worker: define worker protocol + schemas","description":"Define the Timer polling worker request/response protocol for Effect WorkerRunner (Schema-tagged requests). Include StartPolling config payload (intervalMs etc. even if defaulted to 5s initially) and StopPolling. Decide minimal response/ack shape.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-16T12:28:18.100104+01:00","updated_at":"2025-12-17T19:21:46.427677+01:00","labels":["Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-cpx","depends_on_id":"event-service-agent-kata-axe","type":"discovered-from","created_at":"2025-12-16T12:28:47.537688+01:00","created_by":"daemon"}]}
{"id":"event-service-agent-kata-e8c","title":"Test beads integration post-lefthook changes","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-15T20:00:51.804006+01:00","updated_at":"2025-12-15T20:01:07.012878+01:00","closed_at":"2025-12-15T20:01:07.012878+01:00","close_reason":"Validation test completed - beads and lefthook integration working correctly"}
{"id":"event-service-agent-kata-elk","title":"Timer worker migration: tests (protocol, worker lifecycle, shutdown)","description":"Update/replace PollingWorker tests to match worker-thread isolation. Add tests for protocol encode/decode, StartPolling triggers at least one poll, config message is received, and main-thread shutdown interrupts/stops worker within bounded time. Remove or refactor TestClock-based interval tests that no longer apply across threads.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T12:28:31.917761+01:00","updated_at":"2025-12-16T12:28:31.917761+01:00","labels":["Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-elk","depends_on_id":"event-service-agent-kata-axe","type":"discovered-from","created_at":"2025-12-16T12:28:54.097265+01:00","created_by":"daemon"}]}
{"id":"event-service-agent-kata-f86","title":"Choose broker adapter details for dev/prod parity","description":"ADR-0002 related. Define specific broker adapter implementation details for both development and production environments.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-14T22:03:52.109647189Z","updated_at":"2025-12-14T22:03:52.109647189Z","labels":["ADR-0002","PL-13","infra"]}
{"id":"event-service-agent-kata-hjq","title":"Timer runtime main: spawn worker + subscribe to commands + propagate shutdown","description":"Implement/adjust Timer main-thread runtime: subscribe to ScheduleTimer commands, spawn exactly one polling worker via @effect/platform-bun BunWorker, send StartPolling(config) once (fire-and-forget by forking), and propagate shutdown/interrupt to worker. Decide fail-fast vs restart (default: fail-fast + clear logs).","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T12:28:27.804797+01:00","updated_at":"2025-12-16T12:28:27.804797+01:00","labels":["Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-hjq","depends_on_id":"event-service-agent-kata-axe","type":"discovered-from","created_at":"2025-12-16T12:28:51.508375+01:00","created_by":"daemon"}]}
{"id":"event-service-agent-kata-ibg","title":"Broker adapter implementation + local broker setup","description":"Implement EventBusPort adapter for the chosen broker (see ADR-0002) with partition/subject routing by tenantId.serviceCallId. Provide docker-compose for local broker.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-14T22:04:44.75878406Z","updated_at":"2025-12-14T22:04:44.75878406Z","labels":["ADR-0002","PL-3","infra"]}
{"id":"event-service-agent-kata-l5w","title":"Refactor EventBusPort to use pure domain types","description":"COMPLETE: Option B2 implementation with 15 commits across 4 phases. Port accepts pure domain events, adapter wraps in MessageEnvelope. All 282 tests passing.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T22:06:16.503289633Z","updated_at":"2025-12-14T22:06:25.983003215Z","closed_at":"2025-12-14T22:06:25.983003215Z","labels":["PL-23","Timer","architecture"],"dependencies":[{"issue_id":"event-service-agent-kata-l5w","depends_on_id":"event-service-agent-kata-ymr","type":"parent-child","created_at":"2025-12-14T22:06:25.997069497Z","created_by":"daemon"}]}
{"id":"event-service-agent-kata-rad","title":"Confirm monolith boundaries (API inside vs separate; Execution worker split)","description":"ADR-0001 related. Clarify if API module runs within the monolith or separately. Define Execution worker isolation strategy.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-14T22:04:16.220372282Z","updated_at":"2025-12-14T22:04:16.220372282Z","labels":["ADR-0001","PL-20"]}
{"id":"event-service-agent-kata-ryb","title":"Observability baseline","description":"ADR-0009 related. Set up structured logging with correlation IDs and minimal metrics per module. Blocked by ADR-0002 (broker decision).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-14T22:04:24.731052191Z","updated_at":"2025-12-14T22:04:24.731052191Z","labels":["ADR-0009","PL-9","infra"],"dependencies":[{"issue_id":"event-service-agent-kata-ryb","depends_on_id":"event-service-agent-kata-f86","type":"blocks","created_at":"2025-12-14T22:04:34.782761889Z","created_by":"daemon"}]}
{"id":"event-service-agent-kata-tkj","title":"MessageMetadata Context for correlationId propagation","description":"COMPLETE: Option E (Ambient Context) implementation. Created MessageMetadata Context.Tag with correlationId/causationId fields. Updated TimerEventBusPort signatures. PR#37 merged.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T22:05:58.271477445Z","updated_at":"2025-12-14T22:06:06.918063868Z","closed_at":"2025-12-14T22:06:06.918063868Z","labels":["ADR-0013","PL-24","Timer","platform"],"dependencies":[{"issue_id":"event-service-agent-kata-tkj","depends_on_id":"event-service-agent-kata-ymr","type":"parent-child","created_at":"2025-12-14T22:06:06.931802042Z","created_by":"daemon"}]}
{"id":"event-service-agent-kata-van","title":"Persistence adapter (SQLite) and migrations","description":"Implement PersistencePort with SQLite adapter. Schema reflecting domain state and outbox table. Guarded updates and basic list/detail queries with filters.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-14T22:05:02.64983543Z","updated_at":"2025-12-14T22:05:02.64983543Z","labels":["ADR-0004","ADR-0005","PL-6","infra"]}
{"id":"event-service-agent-kata-vgc","title":"Poll-based timer worker implementation","description":"Implement the missing piece to make timers actually fire. Depends on completed PL-4.6 (persistence) and existing workflows.\n\n**CURRENT STATUS**: FINAL STAGE - Documentation only, all functionality complete.\n\n**Progress**:\n- [x] (PL-4.4.1) Layer composition (TimerLive) — compose adapters, verify no missing deps\n- [x] (PL-4.4.2) Polling loop — PollingWorker.run with Schedule.fixed(5s), error recovery, 4 tests passing\n- [x] (PL-4.4.3) Command subscription — inlined in main, retry with exponential backoff (3 retries)\n- [x] (PL-4.4.4) Module main program (Timer.main) — forkScoped for polling, command subscription in main fiber\n- [x] (PL-4.4.5) Integration tests — 11/13 passing (2 skipped: retry policy + error injection blocked), full E2E coverage\n- [ ] (PL-4.4.6) Documentation \u0026 export — update README, design docs, package exports\n\n**Notes**:\n- Timer.main fully functional with 11/13 integration tests passing\n- All core features working: polling, command subscription, multi-tenancy, idempotency, fiber lifecycle\n- 2 tests skipped (documented blockers: retry policy + error injection layer composition)\n- Error injection tests: Applied YAGNI principle — documented pattern, skipped tests, deferred to workflow-level testing\n- Test suite health: 327/329 tests passing (2 skipped), 20 commits on feature branch\n- Branch: timer/pl-4.4-polling-worker\n- Ready to merge in ~1-2 hours after documentation complete","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-14T22:05:22.510323561Z","updated_at":"2025-12-15T20:45:23.983976+01:00","labels":["PL-4.4","Timer"],"dependencies":[{"issue_id":"event-service-agent-kata-vgc","depends_on_id":"event-service-agent-kata-ymr","type":"parent-child","created_at":"2025-12-14T22:05:40.508671079Z","created_by":"daemon"}]}
{"id":"event-service-agent-kata-ymr","title":"Timer module completion","description":"Complete the Timer module with all remaining work items. Parent epic for Timer-related tasks.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-14T22:05:30.79780366Z","updated_at":"2025-12-14T22:05:30.79780366Z","labels":["Timer"]}
